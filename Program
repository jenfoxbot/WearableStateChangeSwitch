/*Wearable State Change Switch!
//by jenfoxbot <jenfoxbot@gmail.com>

Read in a pushbutton to change settings for a project!
This sketch changes the blink rate of an EL Wire connected 
to the EL Sequencer microcontroller.
*/

//This is where the button digital input goes
int buttonInput = A0;

//These are variables to store button states
int buttonPushCounter = 0;
int buttonState = 0;
int lastButtonState = 0;
int buttonCounter = 0;

void setup() {
  Serial.begin(9600);

  //Initialze all pins
  pinMode(2, OUTPUT); //Channel A on the EL Squencer
  pinMode(buttonInput, INPUT); //Button input pin
  
}

void loop() {
//Read pushbutton input pin
buttonCounter = buttonPush();

if(buttonCounter %2 == 0){
      slowFlash();
    }
   else if(buttonCounter %3 == 0){
     fastFlash();
   }
    
   else {
      lightsOn();
    } 
}


int buttonPush(){

  buttonState = digitalRead(buttonInput);

  //Compare buttonState to previous state
  if (buttonState != lastButtonState){
    //If state has changed, increment the counter
    if (buttonState == HIGH){
      //if current state is HIGH, then button went from off to on
      buttonPushCounter++;
      
    /*  Uncomment these next few lines to help debug
     *   Serial.println("On!");
     // Serial.println("Number of button pushes: ");
     // Serial.println(buttonPushCounter);
     }
     else{
     // Serial.println("Off");
     }*/
    
     }
     delay(50);
  }
  lastButtonState = buttonState;
  return buttonPushCounter;

}

void fastFlash(){
  
    lightsOn();
    delay(750);
    lightsOff();
    delay(500);
}


void slowFlash(){
  
    lightsOn();
    delay(1500);
    lightsOff();
    delay(1000);
}

void lightsOn(){

        digitalWrite(2, HIGH); //turn EL channel on
        digitalWrite(3, HIGH);
        digitalWrite(4, HIGH);       
}

void lightsOff(){
        digitalWrite(2, LOW); //turn EL channel off
        digitalWrite(3, LOW);
        digitalWrite(4, LOW);
}
